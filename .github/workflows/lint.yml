name: Lint

on:
  push:
  pull_request:

permissions:
  contents: read

jobs:
  nginx:
    runs-on: ubuntu-latest
    steps:
      - name: Clone the source code
        uses: actions/checkout@v4.2.2

      - name: Set up Python
        uses: actions/setup-python@v5.4.0
        with:
          python-version: "3.11"

      - name: Upgrade pip
        run: python -m pip install --upgrade pip

      - name: Install Gixy
        run: pip install gixy-ng

      - name: Run Gixy
        run: gixy files/nginx.conf

      - name: Check the Nginx configuration
        run: sudo nginx -t -c ./nginx.conf
        working-directory: files
